<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>My first three.js app</title>
		<style>
			body { margin: 0; }
			canvas { width: 100%; height: 100% }
		</style>
	</head>
	<body>

    <link rel="icon" href="https://cdn.discordapp.com/<attachm></attachm>ents/402520016139845633/640611271372308480/favicon.ico">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r79/three.js"></script>
    <!-- <script src="https://cdn.jsdelivr.net/gh/mrdoob/three.js@r92/examples/js/loaders/GLTFLoader.js"></script> -->
    <script src='https://mamboleoo.be/learnThree/demos/OBJLoader.js'></script>
    <script src="https://unpkg.com/three@0.85.0/examples/js/controls/OrbitControls.js"></script>
    <script src="//mrdoob.github.io/stats.js/build/stats.min.js"></script>

    <!-- Fragment shader for colours -->
    <script id="simplefrag" type="x-shader/x-fragment">

	  // Set up variables
      #ifdef GL_ES
      precision highp float;
      #endif
      #include <common>
      varying vec2 texcoord;
      uniform sampler2D text;
      uniform vec2 positions[16];
  	  uniform float data[16];
      const int num = 16;

	  // Set up colourmap components
      float colormap_red(float x) {
          if (x < 0.7) {
              return 4.0 * x - 1.5;
          } else {
              return -4.0 * x + 4.5;
          }
      }

      float colormap_green(float x) {
          if (x < 0.5) {
              return 4.0 * x - 0.5;
          } else {
              return -4.0 * x + 3.5;
          }
      }

      float colormap_blue(float x) {
          if (x < 0.3) {
             return 4.0 * x + 0.5;
          } else {
             return -4.0 * x + 2.5;
          }
      }

      // Colourmap function
      vec4 colormap(float x) {
          float r = clamp(colormap_red(x), 0.0, 1.0);
          float g = clamp(colormap_green(x), 0.0, 1.0);
          float b = clamp(colormap_blue(x), 0.0, 1.0);
          return vec4(r, g, b, 1.0);
      }

	  // Main function for colouring each pixel according to position and sensors
      void main( void ) {
          float val = texture2D(text, texcoord).r;
          float finalcol = 0.;

		  // Iterates through each sensor, adding value to finalcol
          for(int i = 0; i < num; i++) {
              finalcol += data[i]*exp(-1.*pow((distance(positions[i], texcoord) / 0.05), 2.));
          }

		  //Creates colour for pixel
		  gl_FragColor = colormap(clamp(finalcol * val, 0., 1.));
      }

    </script>


    <!-- Vertex shader for UV coordinates -->
    <script type="x-shader/x-vertex" id="vertexshader">

            // switch on high precision floats
            #ifdef GL_ES
            precision highp float;
            #endif
            varying vec2 texcoord;
            void main()
            {
                gl_Position = projectionMatrix * modelViewMatrix * vec4(position,1.0);
                texcoord  = uv;
            }

    </script>
    <script src="/index.js" type="text/javascript"></script>


	</body>
</html>
